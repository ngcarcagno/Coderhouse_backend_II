<div class="products-page">
  {{> header title="Catálogo" }}
  
  <div id="messages" class="messages"></div>

  <div class="catalog-container">
    <div class="products-layout three-column">
      <aside class="products-left">
        <div class="filters">
          <h4>Marcas</h4>
            <div id="brandFilters" class="filters-list">
            {{#if filters.brands}}
              {{#each filters.brands}}
                <label><input type="checkbox" data-filter-type="brand" value="{{this}}" /> {{this}}</label>
              {{/each}}
            {{/if}}
          </div>

          <h4>Categorías</h4>
            <div id="categoryFilters" class="filters-list">
            {{#if filters.categories}}
              {{#each filters.categories}}
                <label><input type="checkbox" data-filter-type="category" value="{{this}}" /> {{this}}</label>
              {{/each}}
            {{/if}}
          </div>

            <div class="filters-availability">
              <h4>Disponibilidad</h4>
              <label style="display:flex;align-items:center;gap:8px"><input id="filterAvailable" type="checkbox" /> En stock</label>
            </div>
          </div>
      </aside>
  <main class="catalog">
        <div class="catalog-controls-row" style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px">
          <div class="catalog-meta">Mostrando {{meta.showingFrom}} - {{meta.showingTo}} de {{meta.totalDocs}}</div>
          <div class="catalog-controls" style="display:flex;gap:8px;align-items:center;">
            <label>Orden:
              <select id="sortSelect">
                <option value="">Sin orden</option>
                <option value="price_asc">Precio ↑</option>
                <option value="price_desc">Precio ↓</option>
                <option value="brand_asc">Marca A-Z</option>
                <option value="brand_desc">Marca Z-A</option>
              </select>
            </label>
          </div>
        </div>
        <div id="productsList" data-limit="{{products.limit}}" style="display:none"></div>
      <div class="list-container">
        <div class="products-grid list">
          {{#each products.docs}}
            <div class="product-card list-entry" data-brand="{{brand}}" data-category="{{category}}">
              <div class="thumb">
                <a href="#" class="open-product" data-id="{{#if this._id}}{{this._id}}{{else}}{{this.id}}{{/if}}">
                  <img src="{{#if thumbnails.[0]}}{{thumbnails.[0]}}{{else}}https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTHHD14b-4jc2n7NeWejZ_smA8OQ4xPR6P80w&s{{/if}}" alt="{{brand}} {{model}}" width="84" height="64">
                </a>
              </div>
              <div class="info">
                <h3 class="title"><a href="#" class="open-product" data-id="{{#if this._id}}{{this._id}}{{else}}{{this.id}}{{/if}}" style="color:inherit;text-decoration:none">{{brand}} {{model}}</a></h3>
                <div class="meta-line">
                  <div class="price">$ {{price}}</div>
                  <div class="size">{{size}}</div>
                  <div class="stock">{{#if stock}}En stock: {{stock}}{{else}}Sin stock{{/if}}</div>
                </div>
                <p class="desc">{{description}}</p>
              </div>
              <div class="actions">
                <div style="display:flex;align-items:center;gap:8px">
                  <input type="number" min="1" value="1" class="qty" data-id="{{#if this._id}}{{this._id}}{{else}}{{this.id}}{{/if}}" style="width:64px;padding:6px;border-radius:6px;border:1px solid #e0e6f3;text-align:center;" />
                  <button class="add-to-cart" data-id="{{#if this._id}}{{this._id}}{{else}}{{this.id}}{{/if}}">Agregar</button>
                </div>
              </div>
            </div>
          {{/each}}
        </div>
      </div>

      <div class="pagination">
        {{#if prevLink}}
          <a href="{{prevLink}}">&laquo; Prev</a>
        {{/if}}
        <span>Page {{meta.page}} / {{meta.totalPages}}</span>
        {{#if nextLink}}
          <a href="{{nextLink}}">Next &raquo;</a>
        {{/if}}
        <label> | Per page:
          <select id="limitSelect">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="20">20</option>
          </select>
        </label>
      </div> <!-- pagination -->

      </main>
      <aside class="products-right">
        <!-- Reserved for future content (ads, recommendations) -->
      </aside>
    </div> <!-- products-layout -->
  </div> <!-- catalog-container -->

  <!-- page-specific assets -->
  <link rel="stylesheet" href="/static/css/products.css">
  <script defer src="/static/js/products-list.js"></script>

</div> <!-- products-page -->
